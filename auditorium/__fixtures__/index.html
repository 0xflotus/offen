<!DOCTYPE html>
<html>
<head>
  <title>auditorium test</title>
</head>
<body>
  <script type="text/javascript">
    var loginResponses = [
      {
        type: 'LOGIN_SUCCESS',
        payload: {
          user: { userId: 'some-id' }
        }
      },
      {
        type: 'LOGIN_FAILURE',
        payload: {
          message: 'Session expired'
        }
      },
      {
        type: 'ERROR',
        payload: {
          error: 'did not work',
          status: 500
        }
      }
    ]
    var loginCalled = 0
    window.addEventListener('message', function (event) {
      if (event.data.type === 'QUERY') {
        event.ports[0].postMessage({
          payload: {
            result: {
              value: 99
            }
          }
        })
      }
      if (event.data.type === 'OPTIN_STATUS') {
        event.ports[0].postMessage({
          payload: {
            result: {
              hasOptedIn: true,
              allowsCookies: true
            }
          }
        })
      }
      if (event.data.type === 'LOGIN') {
        event.ports[0].postMessage(loginResponses[loginCalled])
        loginCalled++
      }
      if (event.data.type === 'OPTIN') {
        event.ports[0].postMessage({
          payload: null
        })
      }
    })
  </script>
</body>
</html>
